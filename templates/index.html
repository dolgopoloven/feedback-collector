{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 text-center">
        <h1>–û—Ü–µ–Ω–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞</h1>
        <p class="lead">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ü–µ–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É –∫–ª–∏–Ω–∏–∫–∏ –∏ –¥–æ–∫—Ç–æ—Ä–∞</p>
        {% if specialist.position %}
            <p class="text-muted">{{ specialist.name }}</p>
            <p class="text-muted">{{ specialist.position }}</p>
        {% endif %}

        <!-- –í—ã–±–æ—Ä —Å–∏–º–≤–æ–ª–∞ -->
        <div class="symbol-selector mb-4">
            <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∏–º–≤–æ–ª –¥–ª—è –æ—Ü–µ–Ω–∫–∏:</label>
            <div class="symbol-options">
                {% set symbols = [
                    {'char': '‚≠ê', 'name': '–ó–≤–µ–∑–¥–∞'},
                    {'char': '‚ù§Ô∏è', 'name': '–°–µ—Ä–¥—Ü–µ'},
                    {'char': 'üëç', 'name': '–ü–∞–ª–µ—Ü –≤–≤–µ—Ä—Ö'},
                    {'char': 'üî•', 'name': '–û–≥–æ–Ω—å'},
                    {'char': 'üéØ', 'name': '–ú–∏—à–µ–Ω—å'},
                    {'char': 'üíé', 'name': '–ê–ª–º–∞–∑'},
                    {'char': 'üòä', 'name': '–£–ª—ã–±–∫–∞'},
                    {'char': 'üí©', 'name': '–ö–∞–∫–∞—à–∫–∞'},
                    {'char': 'ü™º', 'name': '–ú–µ–¥—É–∑–∞'},
                    {'char': 'üßå', 'name': '–¢—Ä–æ–ª–ª—å'},
                    {'char': 'üßû‚Äç‚ôÇ', 'name': '–î–∂–∏–Ω–Ω'},
                    {'char': 'ü´ê', 'name': '–ì–æ–ª—É–±–∏–∫–∞'},
                    {'char': 'üíÆ', 'name': '–¶–≤–µ—Ç–æ–∫'},
                    {'char': 'üá∑üá∫', 'name': '–ü–∞—Ç—Ä–∏–æ—Ç'},
                    {'char': 'ü™≥', 'name': '–¢–∞—Ä–∞–∫–∞–Ω'},
                    {'char': 'üòé', 'name': '–ß–µ–ª-–≤-–æ—á–∫–∞—Ö'}
                    
                ] %}
                
                {% for symbol in symbols %}
                    <div class="symbol-option {% if loop.first %}active{% endif %}" 
                         data-char="{{ symbol.char }}">
                        <span class="symbol">{{ symbol.char }}</span>
                        <small class="symbol-name">{{ symbol.name }}</small>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- –†–µ–π—Ç–∏–Ω–≥ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Å–∏–º–≤–æ–ª–æ–º -->
        <div class="rating-container mb-4">
            <div class="rating-symbols" id="ratingSymbols">
                {% for i in range(1, 11) %}
                    <span class="rating-symbol" data-value="{{ i * 1 }}">
                        ‚≠ê
                    </span>
                {% endfor %}
            </div>
        </div>

        <!-- –§–æ—Ä–º–∞ -->
        <form action="{{ url_for('submit_score', token=token) }}" method="POST">
            <input type="hidden" name="score" id="ratingValue" value="" required>
            <button type="submit" class="btn btn-primary btn-lg" id="submitBtn" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É</button>
        </form>

        <p class="text-muted small mt-3">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç 1 –¥–æ 10 —Å–∏–º–≤–æ–ª–æ–≤</p>
    </div>
</div>

<style>
.symbol-selector {
    margin-bottom: 2rem;
}

.symbol-options {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin-top: 10px;
}

.symbol-option {
    cursor: pointer;
    padding: 10px;
    border: 2px solid #dee2e6;
    border-radius: 10px;
    text-align: center;
    transition: all 0.3s ease;
    min-width: 80px;
}

.symbol-option:hover {
    border-color: #adb5bd;
    transform: translateY(-2px);
}

.symbol-option.active {
    border-color: #0d6efd;
    background-color: #e7f1ff;
}

.symbol {
    font-size: 2rem;
    display: block;
}

.symbol-name {
    display: block;
    margin-top: 5px;
    font-size: 0.8rem;
    color: #6c757d;
}

.rating-symbols {
    display: flex;
    justify-content: center;
    gap: 15px;
    font-size: 3rem;
    margin: 2rem 0;
}

.rating-symbol {
    cursor: pointer;
    opacity: 0.3;
    transition: all 0.3s ease;
    transform: scale(1);
}

.rating-symbol:hover,
.rating-symbol.selected {
    opacity: 1;
    transform: scale(1.2);
}

.rating-symbol:hover ~ .rating-symbol {
    opacity: 0.3;
    transform: scale(1);
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    let selectedSymbol = '‚≠ê';
    
    // –í—ã–±–æ—Ä —Å–∏–º–≤–æ–ª–∞
    document.querySelectorAll('.symbol-option').forEach(option => {
        option.addEventListener('click', function() {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É –≤—Å–µ—Ö
            document.querySelectorAll('.symbol-option').forEach(opt => {
                opt.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–º—É
            this.classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª
            selectedSymbol = this.getAttribute('data-char');
            updateRatingSymbols();
        });
    });
    
    // –í—ã–±–æ—Ä —Ä–µ–π—Ç–∏–Ω–≥–∞
    document.querySelectorAll('.rating-symbol').forEach(symbol => {
        symbol.addEventListener('click', function() {
            const value = this.getAttribute('data-value');
            document.getElementById('ratingValue').value = value;
            
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
            document.querySelectorAll('.rating-symbol').forEach(s => {
                s.classList.remove('selected');
            });
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∏ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ
            let current = this;
            while (current) {
                if (current.classList.contains('rating-symbol')) {
                    current.classList.add('selected');
                }
                current = current.previousElementSibling;
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            document.getElementById('submitBtn').disabled = false;
        });
    });
    
    function updateRatingSymbols() {
        const ratingSymbols = document.getElementById('ratingSymbols');
        ratingSymbols.querySelectorAll('.rating-symbol').forEach(symbol => {
            symbol.textContent = selectedSymbol;
        });
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateRatingSymbols();
});
</script>
{% endblock %}